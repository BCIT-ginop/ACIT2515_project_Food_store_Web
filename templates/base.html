<!DOCTYPE html>
<html>
  <head>
    <title>{% block pagetitle %}Store{% endblock %}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>

  <body>
    <nav>
      <a href="{{ url_for('home') }}">Home</a>
      <a href="{{ url_for('products') }}">Products</a>
      <a href="{{ url_for('categories') }}">Categories</a>
      <a href="{{ url_for('customers') }}">Customers</a>
      <a href="{{ url_for('orders') }}">Orders</a>
      <a href="{{ url_for('cart') }}">Cart</a>
    </nav>
    <div class="container">{% block content %}{% endblock %}</div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".add-to-cart-form").forEach((form) => {
          form.addEventListener("submit", async function (e) {
            e.preventDefault();

            const formData = new FormData(this);
            const button = this.querySelector("button");
            const originalText = button.textContent;

            button.textContent = "Added!";
            button.disabled = true;

            try {
              await fetch("/add_to_cart", {
                method: "POST",
                body: formData,
              });

              setTimeout(() => {
                button.textContent = originalText;
                button.disabled = false;
              }, 1000);
            } catch (error) {
              console.error("Error:", error);
              button.textContent = "Error";
            }
          });
        });
      });
    </script>
  </body>
</html>
